"use strict";var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var pluginName="tnwSticky",TNWSticky=function(){function a(b,c){_classCallCheck(this,a),this.options=$.extend({},this.defaults,c),this.$el=$(b),this.init()}return _createClass(a,[{key:"init",value:function init(){this.$content=this.$el.find("."+this.options.classNameContent).first(),window.hasOwnProperty("Modernizr")&&Modernizr.csspositionsticky?this.$content.css({"-webkit-position":"sticky",position:"sticky","-webkit-transform":"translate3d(0, 0, 0)",transform:"translate3d(0, 0, 0)"}):(this.$content.wrap($("<div/>").addClass(this.options.classNameContentWrapper)),this.$contentWrapper=this.$content.parent(),this.$contentWrapper.css("width","100%"),this.contentHeight=0,this.contentTop=0,this.isStickable=!1,this.isVisible=!1,this.offset=this.$el.attr("data-sticky-offset")||0,this.stickyEnd=0,this.stickyStart=0,this.updateBounds(),this.interval=setInterval(this.updateBounds.bind(this),this.options.updateInterval),$(window).on("orientationchange resize",this.onResize.bind(this)),$(window).on("tnw:scroll",this.onScroll.bind(this)))}},{key:"onResize",value:function onResize(){this.interval&&clearInterval(this.interval),this.$content.css({bottom:"auto",position:"static",top:0}),setTimeout(this.updateBounds.bind(this),10),this.interval=setInterval(this.updateBounds,this.options.updateInterval)}},{key:"onScroll",value:function onScroll(a){this.isStickable&&this.isVisible&&(a.top>this.stickyStart?a.top+this.contentHeight<this.stickyEnd?this.$content.css({bottom:"auto",position:"fixed",top:this.offset+"px"}):this.$content.css({bottom:this.$el.css("padding-bottom"),position:"absolute",top:"auto"}):this.$content.css({bottom:"auto",position:"static",top:0}))}},{key:"updateBounds",value:function updateBounds(){this.isVisible=this.$el.is(":visible"),this.isVisible&&(this.$content.css("width",this.$contentWrapper.width()),this.contentHeight=Math.ceil(this.$content.outerHeight(!0)),this.contentTop=this.$contentWrapper.offset().top,this.stickyStart=this.contentTop-this.offset,this.stickyEnd=this.contentTop+this.$el.height()-this.offset,this.isStickable=this.$el.height()>this.contentHeight,$(window).on("orientationchange resize",this.onResize.bind(this)))}}]),a}();TNWSticky.prototype.defaults={classNameContent:"js-tnwSticky-content",classNameContentWrapper:"js-tnwSticky-contentWrapper",updateInterval:1e3},$.fn[pluginName]=function(a){return this.each(function(){var b=$(this).data(pluginName);b?"string"==typeof a&&b[a]():$(this).data(pluginName,new TNWSticky(this,a))})};
